#include<stdio.h>
#define int long long
signed main(){
    int t;
    scanf("%lld",&t);
    while(t--){
        int n,q,x,y,b1,b2,b3,g1,g2,g3,r1,r2,r3,y1,y2,y3;
        scanf("%lld %lld",&n,&q);
        char s[n][3];
        for(int i=0;i<n;i++) scanf("%s",s[i]);
        b1=b2=b3=g1=g2=g3=r1=r2=r3=y1=y2=y3=-1;
        int b[n],c[n];
        for(int i=0;i<n;i++){
            b[i]=10000000000;
            if(b1!=-1){
                if((s[i][0]==s[b1][0] && s[i][1]==s[b1][1]) || (s[i][0]==s[b1][1] && s[i][1]==s[b1][0])){}
                else if((s[i][0]==s[b1][0] || s[i][1]==s[b1][1]) || (s[i][0]==s[b1][1] || s[i][1]==s[b1][0])){
                    if(i-b1<b[i]) b[i]=i-b1;
                }
            }
            if(b2!=-1){
                if((s[i][0]==s[b2][0] && s[i][1]==s[b2][1]) || (s[i][0]==s[b2][1] && s[i][1]==s[b2][0])){}
                else if((s[i][0]==s[b2][0] || s[i][1]==s[b2][1]) || (s[i][0]==s[b2][1] || s[i][1]==s[b2][0])){
                    if(i-b2<b[i]) b[i]=i-b2;
                }
            }
            if(b3!=-1){
                if((s[i][0]==s[b3][0] && s[i][1]==s[b3][1]) || (s[i][0]==s[b3][1] && s[i][1]==s[b3][0])){}
                else if((s[i][0]==s[b3][0] || s[i][1]==s[b3][1]) || (s[i][0]==s[b3][1] || s[i][1]==s[b3][0])){
                    if(i-b3<b[i]) b[i]=i-b3;
                }
            }
            if(g1!=-1){
                if((s[i][0]==s[g1][0] && s[i][1]==s[g1][1]) || (s[i][0]==s[g1][1] && s[i][1]==s[g1][0])){}
                else if((s[i][0]==s[g1][0] || s[i][1]==s[g1][1]) || (s[i][0]==s[g1][1] || s[i][1]==s[g1][0])){
                    if(i-g1<b[i]) b[i]=i-g1;
                }
            }
            if(g2!=-1){
                if((s[i][0]==s[g2][0] && s[i][1]==s[g2][1]) || (s[i][0]==s[g2][1] && s[i][1]==s[g2][0])){}
                else if((s[i][0]==s[g2][0] || s[i][1]==s[g2][1]) || (s[i][0]==s[g2][1] || s[i][1]==s[g2][0])){
                    if(i-g2<b[i]) b[i]=i-g2;
                }
            }
            if(g3!=-1){
                if((s[i][0]==s[g3][0] && s[i][1]==s[g3][1]) || (s[i][0]==s[g3][1] && s[i][1]==s[g3][0])){}
                else if((s[i][0]==s[g3][0] || s[i][1]==s[g3][1]) || (s[i][0]==s[g3][1] || s[i][1]==s[g3][0])){
                    if(i-g3<b[i]) b[i]=i-g3;
                }
            }
            if(r1!=-1){
                if((s[i][0]==s[r1][0] && s[i][1]==s[r1][1]) || (s[i][0]==s[r1][1] && s[i][1]==s[r1][0])){}
                else if((s[i][0]==s[r1][0] || s[i][1]==s[r1][1]) || (s[i][0]==s[r1][1] || s[i][1]==s[r1][0])){
                    if(i-r1<b[i]) b[i]=i-r1;
                }
            }
            if(r2!=-1){
                if((s[i][0]==s[r2][0] && s[i][1]==s[r2][1]) || (s[i][0]==s[r2][1] && s[i][1]==s[r2][0])){}
                else if((s[i][0]==s[r2][0] || s[i][1]==s[r2][1]) || (s[i][0]==s[r2][1] || s[i][1]==s[r2][0])){
                    if(i-r2<b[i]) b[i]=i-r2;
                }
            }
            if(r3!=-1){
                if((s[i][0]==s[r3][0] && s[i][1]==s[r3][1]) || (s[i][0]==s[r3][1] && s[i][1]==s[r3][0])){}
                else if((s[i][0]==s[r3][0] || s[i][1]==s[r3][1]) || (s[i][0]==s[r3][1] || s[i][1]==s[r3][0])){
                    if(i-r3<b[i]) b[i]=i-r3;
                }
            }
            if(y1!=-1){
                if((s[i][0]==s[y1][0] && s[i][1]==s[y1][1]) || (s[i][0]==s[y1][1] && s[i][1]==s[y1][0])){}
                else if((s[i][0]==s[y1][0] || s[i][1]==s[y1][1]) || (s[i][0]==s[y1][1] || s[i][1]==s[y1][0])){
                    if(i-y1<b[i]) b[i]=i-y1;
                }
            }
            if(y2!=-1){
                if((s[i][0]==s[y2][0] && s[i][1]==s[y2][1]) || (s[i][0]==s[y2][1] && s[i][1]==s[y2][0])){}
                else if((s[i][0]==s[y2][0] || s[i][1]==s[y2][1]) || (s[i][0]==s[y2][1] || s[i][1]==s[y2][0])){
                    if(i-y2<b[i]) b[i]=i-y2;
                }
            }
            if(y3!=-1){
                if((s[i][0]==s[y3][0] && s[i][1]==s[y3][1]) || (s[i][0]==s[y3][1] && s[i][1]==s[y3][0])){}
                else if((s[i][0]==s[y3][0] || s[i][1]==s[y3][1]) || (s[i][0]==s[y3][1] || s[i][1]==s[y3][0])){
                    if(i-y3<b[i]) b[i]=i-y3;
                }
            }
            if(s[i][0]=='B' && s[i][1]=='G') b1=g1=i;
            else if(s[i][0]=='B' && s[i][1]=='R') b2=r1=i;
            else if(s[i][0]=='B' && s[i][1]=='Y') b3=y1=i;
            else if(s[i][0]=='G' && s[i][1]=='R') g2=r2=i;
            else if(s[i][0]=='G' && s[i][1]=='Y') g3=y2=i;
            else if(s[i][0]=='R' && s[i][1]=='Y') r3=y3=i;
        }
        b1=b2=b3=g1=g2=g3=r1=r2=r3=y1=y2=y3=-1;
        for(int i=n-1;i>=0;i--){
            c[i]=10000000000;
            if(b1!=-1){
                if((s[i][0]==s[b1][0] && s[i][1]==s[b1][1]) || (s[i][0]==s[b1][1] && s[i][1]==s[b1][0])){}
                else if((s[i][0]==s[b1][0] || s[i][1]==s[b1][1]) || (s[i][0]==s[b1][1] || s[i][1]==s[b1][0])){
                    if(b1-i<c[i]) c[i]=b1-i;
                }
            }
            if(b2!=-1){
                if((s[i][0]==s[b2][0] && s[i][1]==s[b2][1]) || (s[i][0]==s[b2][1] && s[i][1]==s[b2][0])){}
                else if((s[i][0]==s[b2][0] || s[i][1]==s[b2][1]) || (s[i][0]==s[b2][1] || s[i][1]==s[b2][0])){
                    if(b2-i<c[i]) c[i]=b2-i;
                }
            }
            if(b3!=-1){
                if((s[i][0]==s[b3][0] && s[i][1]==s[b3][1]) || (s[i][0]==s[b3][1] && s[i][1]==s[b3][0])){}
                else if((s[i][0]==s[b3][0] || s[i][1]==s[b3][1]) || (s[i][0]==s[b3][1] || s[i][1]==s[b3][0])){
                    if(b3-i<c[i]) c[i]=b3-i;
                }
            }
            if(g1!=-1){
                if((s[i][0]==s[g1][0] && s[i][1]==s[g1][1]) || (s[i][0]==s[g1][1] && s[i][1]==s[g1][0])){}
                else if((s[i][0]==s[g1][0] || s[i][1]==s[g1][1]) || (s[i][0]==s[g1][1] || s[i][1]==s[g1][0])){
                    if(g1-i<c[i]) c[i]=g1-i;
                }
            }
            if(g2!=-1){
                if((s[i][0]==s[g2][0] && s[i][1]==s[g2][1]) || (s[i][0]==s[g2][1] && s[i][1]==s[g2][0])){}
                else if((s[i][0]==s[g2][0] || s[i][1]==s[g2][1]) || (s[i][0]==s[g2][1] || s[i][1]==s[g2][0])){
                    if(g2-i<c[i]) c[i]=g2-i;
                }
            }
            if(g3!=-1){
                if((s[i][0]==s[g3][0] && s[i][1]==s[g3][1]) || (s[i][0]==s[g3][1] && s[i][1]==s[g3][0])){}
                else if((s[i][0]==s[g3][0] || s[i][1]==s[g3][1]) || (s[i][0]==s[g3][1] || s[i][1]==s[g3][0])){
                    if(g3-i<c[i]) c[i]=g3-i;
                }
            }
            if(r1!=-1){
                if((s[i][0]==s[r1][0] && s[i][1]==s[r1][1]) || (s[i][0]==s[r1][1] && s[i][1]==s[r1][0])){}
                else if((s[i][0]==s[r1][0] || s[i][1]==s[r1][1]) || (s[i][0]==s[r1][1] || s[i][1]==s[r1][0])){
                    if(r1-i<c[i]) c[i]=r1-i;
                }
            }
            if(r2!=-1){
                if((s[i][0]==s[r2][0] && s[i][1]==s[r2][1]) || (s[i][0]==s[r2][1] && s[i][1]==s[r2][0])){}
                else if((s[i][0]==s[r2][0] || s[i][1]==s[r2][1]) || (s[i][0]==s[r2][1] || s[i][1]==s[r2][0])){
                    if(r2-i<c[i]) c[i]=r2-i;
                }
            }
            if(r3!=-1){
                if((s[i][0]==s[r3][0] && s[i][1]==s[r3][1]) || (s[i][0]==s[r3][1] && s[i][1]==s[r3][0])){}
                else if((s[i][0]==s[r3][0] || s[i][1]==s[r3][1]) || (s[i][0]==s[r3][1] || s[i][1]==s[r3][0])){
                    if(r3-i<c[i]) c[i]=r3-i;
                }
            }
            if(y1!=-1){
                if((s[i][0]==s[y1][0] && s[i][1]==s[y1][1]) || (s[i][0]==s[y1][1] && s[i][1]==s[y1][0])){}
                else if((s[i][0]==s[y1][0] || s[i][1]==s[y1][1]) || (s[i][0]==s[y1][1] || s[i][1]==s[y1][0])){
                    if(y1-i<c[i]) c[i]=y1-i;
                }
            }
            if(y2!=-1){
                if((s[i][0]==s[y2][0] && s[i][1]==s[y2][1]) || (s[i][0]==s[y2][1] && s[i][1]==s[y2][0])){}
                else if((s[i][0]==s[y2][0] || s[i][1]==s[y2][1]) || (s[i][0]==s[y2][1] || s[i][1]==s[y2][0])){
                    if(y2-i<c[i]) c[i]=y2-i;
                }
            }
            if(y3!=-1){
                if((s[i][0]==s[y3][0] && s[i][1]==s[y3][1]) || (s[i][0]==s[y3][1] && s[i][1]==s[y3][0])){}
                else if((s[i][0]==s[y3][0] || s[i][1]==s[y3][1]) || (s[i][0]==s[y3][1] || s[i][1]==s[y3][0])){
                    if(y3-i<c[i]) c[i]=y3-i;
                }
            }
            if(s[i][0]=='B' && s[i][1]=='G') b1=g1=i;
            else if(s[i][0]=='B' && s[i][1]=='R') b2=r1=i;
            else if(s[i][0]=='B' && s[i][1]=='Y') b3=y1=i;
            else if(s[i][0]=='G' && s[i][1]=='R') g2=r2=i;
            else if(s[i][0]=='G' && s[i][1]=='Y') g3=y2=i;
            else if(s[i][0]=='R' && s[i][1]=='Y') r3=y3=i;
        }
        while(q--){
            scanf("%lld %lld",&x,&y);
            x--;
            y--;
            if(x>y){
                int tem=x;
                x=y;
                y=tem;
            }
            if(s[x][0]==s[y][0] || s[x][1]==s[y][1] || s[x][0]==s[y][1] || s[x][1]==s[y][0]) printf("%lld\n",y-x);
            else{
                int min,xl,xr,yl,yr;
                min=xl=xr=yl=yr=10000000000;
                if(b[x]!=10000000000) xl=(y-x)+b[x]+b[x];
                if(c[x]!=10000000000) {
                    if(c[x]>y-x) xr=c[x]+c[x]-(y-x);
                    else xr=y-x;
                }
                if(b[y]!=10000000000) {
                    if(b[y]>y-x) yl=b[y]+b[y]-(y-x);
                    else yl=y-x;
                }
                if(c[y]!=10000000000) yr=c[y]+c[y]+(y-x);
                if(xl<min) min=xl;
                if(xr<min) min=xr;
                if(yl<min) min=yl;
                if(yr<min) min=yr;
                if(min==10000000000) printf("-1\n");
                else printf("%lld\n",min);
            }
        }
    }
}